/****************************************************************************/
/** \file SysReset.c
/** \Author redstoner_35
/** \Project Xtern Ripper Laser Edition 
/** \Description 这个文件负责实现单片机的软重启功能，以及软重启结束后clear掉重启
操作Flag

**	History: Initial Release
**	
*****************************************************************************/
/****************************************************************************/
/*	include files
*****************************************************************************/
#include "cms8s6990.h"
#include "SysReset.h"
/****************************************************************************/
/*	Local pre-processor symbols/macros('#define')
****************************************************************************/

/****************************************************************************/
/*	Global variable definitions(declared in header file with 'extern')
****************************************************************************/

/****************************************************************************/
/*	Local type definitions('typedef')
****************************************************************************/

/****************************************************************************/
/*	Local variable  definitions('static')
****************************************************************************/

/****************************************************************************/
/*	Local function prototypes('static')
****************************************************************************/

/****************************************************************************/
/*	Function implementation - global ('extern') and local('static')
****************************************************************************/

//生成系统复位
#pragma optimize(0)
void TriggerSoftwareReset(void)
	{
	EA=0;
	_nop_();
	TA=0xAA;
  TA=0x55;  //往TA寄存器写55AA解锁
  WDCON=0x80;  //令WDTCON[7]=1，触发系统复位
	while(1);
	}

//清除软件复位标志位
#pragma optimize(0)
void ClearSoftwareResetFlag(void)
	{
	EA=0;
	_nop_();
	TA=0xAA;
  TA=0x55;  //往TA寄存器写55AA解锁
  WDCON&=0x7F;  //令WDTCON[7]=0，清除掉Reset Flag
	}
